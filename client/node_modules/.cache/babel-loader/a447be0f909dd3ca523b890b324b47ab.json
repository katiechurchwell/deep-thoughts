{"ast":null,"code":"import _asyncToGenerator from\"/Users/katiechurchwell/Desktop/code/projects/deep-thoughts/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/katiechurchwell/Desktop/code/projects/deep-thoughts/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/katiechurchwell/Desktop/code/projects/deep-thoughts/client/node_modules/@babel/runtime/regenerator/index.js\";import React from'react';import{Redirect,useParams}from'react-router-dom';import ThoughtForm from'../components/ThoughtForm';import ThoughtList from'../components/ThoughtList';import FriendList from'../components/FriendList';import{useQuery,useMutation}from'@apollo/client';import{QUERY_USER,QUERY_ME}from'../utils/queries';import{ADD_FRIEND}from'../utils/mutations';import Auth from'../utils/auth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Profile=function Profile(props){var _useParams=useParams(),userParam=_useParams.username;var _useMutation=useMutation(ADD_FRIEND),_useMutation2=_slicedToArray(_useMutation,1),addFriend=_useMutation2[0];var _useQuery=useQuery(userParam?QUERY_USER:QUERY_ME,{variables:{username:userParam}}),loading=_useQuery.loading,data=_useQuery.data;var user=(data===null||data===void 0?void 0:data.me)||(data===null||data===void 0?void 0:data.user)||{};// redirect to personal profile page if username is yours\nif(Auth.loggedIn()&&Auth.getProfile().data.username===userParam){return/*#__PURE__*/_jsx(Redirect,{to:\"/profile\"});}if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(!(user!==null&&user!==void 0&&user.username)){return/*#__PURE__*/_jsx(\"h4\",{children:\"You need to be logged in to see this. Use the navigation links above to sign up or log in!\"});}var handleClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return addFriend({variables:{id:user._id}});case 3:_context.next=8;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 8:case\"end\":return _context.stop();}}},_callee,null,[[0,5]]);}));return function handleClick(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-row mb-3\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"bg-dark text-secondary p-3 display-inline-block\",children:[\"Viewing \",userParam?\"\".concat(user.username,\"'s\"):'your',\" profile.\"]}),userParam&&/*#__PURE__*/_jsx(\"button\",{className:\"btn ml-auto\",onClick:handleClick,children:\"Add Friend\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-row justify-space-between mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 mb-3 col-lg-8\",children:/*#__PURE__*/_jsx(ThoughtList,{thoughts:user.thoughts,title:\"\".concat(user.username,\"'s thoughts...\")})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-lg-3 mb-3\",children:/*#__PURE__*/_jsx(FriendList,{username:user.username,friendCount:user.friendCount,friends:user.friends})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-3\",children:!userParam&&/*#__PURE__*/_jsx(ThoughtForm,{})})]});};export default Profile;","map":{"version":3,"sources":["/Users/katiechurchwell/Desktop/code/projects/deep-thoughts/client/src/pages/Profile.js"],"names":["React","Redirect","useParams","ThoughtForm","ThoughtList","FriendList","useQuery","useMutation","QUERY_USER","QUERY_ME","ADD_FRIEND","Auth","Profile","props","userParam","username","addFriend","variables","loading","data","user","me","loggedIn","getProfile","handleClick","id","_id","console","error","thoughts","friendCount","friends"],"mappings":"wcAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,QAAT,CAAmBC,SAAnB,KAAoC,kBAApC,CAEA,MAAOC,CAAAA,WAAP,KAAwB,2BAAxB,CACA,MAAOC,CAAAA,WAAP,KAAwB,2BAAxB,CACA,MAAOC,CAAAA,UAAP,KAAuB,0BAAvB,CAEA,OAASC,QAAT,CAAmBC,WAAnB,KAAsC,gBAAtC,CACA,OAASC,UAAT,CAAqBC,QAArB,KAAqC,kBAArC,CACA,OAASC,UAAT,KAA2B,oBAA3B,CACA,MAAOC,CAAAA,IAAP,KAAiB,eAAjB,C,wFAEA,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAACC,KAAD,CAAW,CACzB,eAAgCX,SAAS,EAAzC,CAAkBY,SAAlB,YAAQC,QAAR,CAEA,iBAAoBR,WAAW,CAACG,UAAD,CAA/B,8CAAOM,SAAP,kBACA,cAA0BV,QAAQ,CAACQ,SAAS,CAAGN,UAAH,CAAgBC,QAA1B,CAAoC,CACpEQ,SAAS,CAAE,CAAEF,QAAQ,CAAED,SAAZ,CADyD,CAApC,CAAlC,CAAQI,OAAR,WAAQA,OAAR,CAAiBC,IAAjB,WAAiBA,IAAjB,CAIA,GAAMC,CAAAA,IAAI,CAAG,CAAAD,IAAI,OAAJ,EAAAA,IAAI,SAAJ,QAAAA,IAAI,CAAEE,EAAN,IAAYF,IAAZ,SAAYA,IAAZ,iBAAYA,IAAI,CAAEC,IAAlB,GAA0B,EAAvC,CAEA;AACA,GAAIT,IAAI,CAACW,QAAL,IAAmBX,IAAI,CAACY,UAAL,GAAkBJ,IAAlB,CAAuBJ,QAAvB,GAAoCD,SAA3D,CAAsE,CACpE,mBAAO,KAAC,QAAD,EAAU,EAAE,CAAC,UAAb,EAAP,CACD,CAED,GAAII,OAAJ,CAAa,CACX,mBAAO,mCAAP,CACD,CAED,GAAI,EAACE,IAAD,SAACA,IAAD,WAACA,IAAI,CAAEL,QAAP,CAAJ,CAAqB,CACnB,mBACE,kHADF,CAMD,CAED,GAAMS,CAAAA,WAAW,0FAAG,yKAEVR,CAAAA,SAAS,CAAC,CACdC,SAAS,CAAE,CAAEQ,EAAE,CAAEL,IAAI,CAACM,GAAX,CADG,CAAD,CAFC,sFAMhBC,OAAO,CAACC,KAAR,cANgB,mEAAH,kBAAXJ,CAAAA,WAAW,0CAAjB,CAUA,mBACE,oCACE,aAAK,SAAS,CAAC,eAAf,wBACE,YAAI,SAAS,CAAC,iDAAd,sBACWV,SAAS,WAAMM,IAAI,CAACL,QAAX,OAA0B,MAD9C,eADF,CAKGD,SAAS,eACR,eAAQ,SAAS,CAAC,aAAlB,CAAgC,OAAO,CAAEU,WAAzC,wBANJ,GADF,cAaE,aAAK,SAAS,CAAC,qCAAf,wBACE,YAAK,SAAS,CAAC,sBAAf,uBACE,KAAC,WAAD,EACE,QAAQ,CAAEJ,IAAI,CAACS,QADjB,CAEE,KAAK,WAAKT,IAAI,CAACL,QAAV,kBAFP,EADF,EADF,cAQE,YAAK,SAAS,CAAC,sBAAf,uBACE,KAAC,UAAD,EACE,QAAQ,CAAEK,IAAI,CAACL,QADjB,CAEE,WAAW,CAAEK,IAAI,CAACU,WAFpB,CAGE,OAAO,CAAEV,IAAI,CAACW,OAHhB,EADF,EARF,GAbF,cA6BE,YAAK,SAAS,CAAC,MAAf,UAAuB,CAACjB,SAAD,eAAc,KAAC,WAAD,IAArC,EA7BF,GADF,CAiCD,CAvED,CAyEA,cAAeF,CAAAA,OAAf","sourcesContent":["import React from 'react';\nimport { Redirect, useParams } from 'react-router-dom';\n\nimport ThoughtForm from '../components/ThoughtForm';\nimport ThoughtList from '../components/ThoughtList';\nimport FriendList from '../components/FriendList';\n\nimport { useQuery, useMutation } from '@apollo/client';\nimport { QUERY_USER, QUERY_ME } from '../utils/queries';\nimport { ADD_FRIEND } from '../utils/mutations';\nimport Auth from '../utils/auth';\n\nconst Profile = (props) => {\n  const { username: userParam } = useParams();\n\n  const [addFriend] = useMutation(ADD_FRIEND);\n  const { loading, data } = useQuery(userParam ? QUERY_USER : QUERY_ME, {\n    variables: { username: userParam },\n  });\n\n  const user = data?.me || data?.user || {};\n\n  // redirect to personal profile page if username is yours\n  if (Auth.loggedIn() && Auth.getProfile().data.username === userParam) {\n    return <Redirect to=\"/profile\" />;\n  }\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  if (!user?.username) {\n    return (\n      <h4>\n        You need to be logged in to see this. Use the navigation links above to\n        sign up or log in!\n      </h4>\n    );\n  }\n\n  const handleClick = async () => {\n    try {\n      await addFriend({\n        variables: { id: user._id },\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  return (\n    <div>\n      <div className=\"flex-row mb-3\">\n        <h2 className=\"bg-dark text-secondary p-3 display-inline-block\">\n          Viewing {userParam ? `${user.username}'s` : 'your'} profile.\n        </h2>\n\n        {userParam && (\n          <button className=\"btn ml-auto\" onClick={handleClick}>\n            Add Friend\n          </button>\n        )}\n      </div>\n\n      <div className=\"flex-row justify-space-between mb-3\">\n        <div className=\"col-12 mb-3 col-lg-8\">\n          <ThoughtList\n            thoughts={user.thoughts}\n            title={`${user.username}'s thoughts...`}\n          />\n        </div>\n\n        <div className=\"col-12 col-lg-3 mb-3\">\n          <FriendList\n            username={user.username}\n            friendCount={user.friendCount}\n            friends={user.friends}\n          />\n        </div>\n      </div>\n      <div className=\"mb-3\">{!userParam && <ThoughtForm />}</div>\n    </div>\n  );\n};\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}